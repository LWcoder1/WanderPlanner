{% extends 'base.html' %} {% block head %} {% endblock %} {% block body %}

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Google Map</title>
    <h1>My Google Map</h1>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      /* Style for the search bar container */
      .search-bar {
        margin-top: 20px; /* Adjust the margin-top as needed */
        text-align: center; /* Center the search bar horizontally */
      }

      /* Style for the search input field */
      #pac-input {
        width: 300px; /* Adjust the width as needed */
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
      }
      #map {
        /* Adjust the height of the map */
        height: 600px;
        /* Adjust the width of the map */
        width: 80%;
        margin: 0 auto; /* Center the map horizontally */
        border: 5px solid var(--deepblue); /* Add border with custom color */
        border-radius: 10px; /* Add border radius for rounded corners */
        background-color: var(--lightgray); /* Set background color */
      }
      h1 {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <!-- Add the search input field -->
    <div class="search-bar">
      <input id="pac-input" type="text" placeholder="Search Box" />
    </div>
    <div id="map"></div>
    <script>
      function initMap() {
        var location = { lat: -25.363, lng: 131.044 };
        var map = new google.maps.Map(document.getElementById("map"), {
          zoom: 4,
          center: location,
        });

        //defines a marker icon with a specific URL and size, sets an initial position for the marker, and creates the marker object with properties including the icon, position, title, and draggable capability. Event listeners are added to handle marker clicks, which zoom the map to the marker's location, and marker dragging, which logs the new position coordinates when dragging ends.
        var markerIcon = {
          url: "https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png", // URL of the marker icon image
          scaledSize: new google.maps.Size(40, 40), // Size of the marker icon
        };
        var markerPosition = { lat: -33.8688, lng: 151.2195 };
        // Create a marker with custom icon and position
        var marker = new google.maps.Marker({
          position: markerPosition,
          map: map,
          icon: markerIcon, // Use custom marker icon
          title: "Custom Marker",
          draggable: true,
        });
        // Add click event listener to the marker
        marker.addListener("click", function () {
          // Zoom in on the marker location
          map.setCenter(marker.getPosition()); // Center the map on marker position
          map.setZoom(16);
        });
        // Add a dragend event listener to the marker
        marker.addListener("dragend", function (event) {
          console.log(
            "Marker dragged to:",
            event.latLng.lat(),
            event.latLng.lng()
          );
        });

        // Autocomplete and SearchBox Code
        var input = document.getElementById("pac-input");
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        map.addListener("bounds_changed", function () {
          searchBox.setBounds(map.getBounds());
        });

        var markers = [];
        searchBox.addListener("places_changed", function () {
          var places = searchBox.getPlaces();

          if (places.length == 0) {
            return;
          }
          markers.forEach(function (marker) {
            marker.setMap(null);
          });
          markers = [];

          var bounds = new google.maps.LatLngBounds();
          places.forEach(function (place) {
            if (!place.geometry) {
              console.log("Returned place contains no geometry");
              return;
            }
            var icon = {
              url: place.icon,
              size: new google.maps.Size(71, 71),
              origin: new google.maps.Point(0, 0),
              anchor: new google.maps.Point(17, 34),
              scaledSize: new google.maps.Size(25, 25),
            };

            markers.push(
              new google.maps.Marker({
                map: map,
                icon: icon,
                title: place.name,
                position: place.geometry.location,
              })
            );

            if (place.geometry.viewport) {
              bounds.union(place.geometry.viewport);
            } else {
              bounds.extend(place.geometry.location);
            }
          });
          map.fitBounds(bounds);
        });
      }
    </script>
    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC25kVhHoyX5OjED2X6jNkXCfLt8TcpEK0&callback=initMap"
    ></script>
  </body>
</html>
{% endblock %}
